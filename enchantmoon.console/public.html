<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
	<style>
	body {
		margin: 0px;
		padding: 20px;
		background: #0f0f0f;
		color: #fefefe;
		font-family: 'Roboto', sans-serif;
	}
	#id {
		font-weight: bold;
		color: #008aff;
		font-size: 120%;
	}
	a {
		color: #008aff;
	}
	</style>
	<script src="/socket.io/socket.io.js"></script>
</head>
<body>
	<h1>enchantMOON.console</h1>

	<h2>Installing the Sticker</h2>
	<ol>
		<li>Download and install the <a href="https://github.com/esmasui/enchantMOON/raw/master/enchantmoon.console/enchantMOON.console.public.zip">sticker</a> on your enchantMOON</li>
	</ol>
	<h2>Connecting enchantMOON</h2>
	<ol>
		<li>Tap the sticker to bring up the prompt, and then enter the following ID: <span id="id">-</span> , then tap OK</li>
		<li>Open JavaScript console on this window, and then call MOON.eval() with any statements you want to execute on your enchantMOON</li>
	</ol>
	<h3>Example</h3>
	<pre>
  MOON.eval('importJS(["lib/MOON.js"], function(){})');
  MOON.eval('MOON.getPaperJSON(MOON.getCurrentPage().backing)');
	</pre>
	<h2>Disconnecting enchantMOON</h2>
	<ol>
		<li>Call MOON.disconnect()</li>
		<li>Cancel the sticker on your enchantMOON</li>
	</ol>
	<script>
	var MOON = {
		eval: function(){},
		disconnect: function(){}
	};
	(function(){
		if(location.hash){
			return;
		}
		var socket = io.connect();
		socket.on("connect", function(){
			document.getElementById("id").innerHTML = socket.socket.sessionid;
			MOON.eval = function(data){
				socket.emit("command", data);
			};
			MOON.disconnect = function(){
				socket.disconnect();
			}
		});
		socket.on("join", function(peer){
			console.log("join: "+peer);
		});
		socket.on("leave", function(peer){
			console.log("leave: "+peer);
		});
		socket.on("proceed", function(data){
			window.proceed = data;
			try{
				console.log(data);
			}catch(e){
				console.log(e.toString());
			}
		});
	})();
	</script>
</body>
</html>